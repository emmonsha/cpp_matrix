
---

## üìò –≠—Ç–∞–ø 5: –ú–∞—Ç—Ä–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî –æ—Ç –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –∫ –∫–æ–¥—É

> üí° –¢—ã –∑–Ω–∞–µ—à—å –º–∞—Ç–µ–º–∞—Ç–∏–∫—É:  
> - –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: \( A^T_{ij} = A_{ji} \)  
> - –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å ‚Äî —á–µ—Ä–µ–∑ –º–∏–Ω–æ—Ä—ã  
> - –û–±—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ ‚Äî —á–µ—Ä–µ–∑ —Å–æ—é–∑–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å  
>
> –¢–µ–ø–µ—Ä—å —Ä–µ–∞–ª–∏–∑—É–µ–º —ç—Ç–æ **–Ω–∞ C++**, —Å —É—á—ë—Ç–æ–º –æ—à–∏–±–æ–∫ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

---

### üîß 5.1. –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª `matrix_ops.cpp`

```bash
touch matrix_ops.cpp
```

–û—Ç–∫—Ä–æ–π –µ–≥–æ:

```cpp
// src/matrix_ops.cpp
#include "s21_matrix_oop.h"
#include <algorithm>
#include <cmath>

namespace s21 {

// === –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: rows x cols ‚Üí cols x rows ===
S21Matrix S21Matrix::Transpose() const {
  // –ù–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞: —Ä–∞–∑–º–µ—Ä—ã –ø–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç—ã
  S21Matrix result(cols_, rows_);

  for (int i = 0; i < rows_; ++i) {
    for (int j = 0; j < cols_; ++j) {
      result.matrix_[j][i] = matrix_[i][j];  // A[j][i] = A^T[i][j]
    }
  }

  return result;
}

// === –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥: –ø–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω–æ—Ä–∞ ===
// –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫—É row –∏ —Å—Ç–æ–ª–±–µ—Ü col
S21Matrix S21Matrix::GetMinorMatrix(int row, int col) const {
  S21Matrix minor(rows_ - 1, cols_ - 1);

  int minor_i = 0;
  for (int i = 0; i < rows_; ++i) {
    if (i == row) continue;  // –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫—É
    int minor_j = 0;
    for (int j = 0; j < cols_; ++j) {
      if (j == col) continue;  // –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç–æ–ª–±–µ—Ü
      minor.matrix_[minor_i][minor_j] = matrix_[i][j];
      ++minor_j;
    }
    ++minor_i;
  }

  return minor;
}

// === –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—è ===
double S21Matrix::CalcDeterminant() const {
  // –ë–∞–∑–æ–≤—ã–µ —Å–ª—É—á–∞–∏
  if (rows_ == 1) {
    return matrix_[0][0];
  }
  if (rows_ == 2) {
    return matrix_[0][0] * matrix_[1][1] - matrix_[0][1] * matrix_[1][0];
  }

  // –î–ª—è –º–∞—Ç—Ä–∏—Ü 3x3 –∏ –±–æ–ª—å—à–µ ‚Äî —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –ø–æ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
  double det = 0;
  for (int j = 0; j < cols_; ++j) {
    // –ú–∏–Ω–æ—Ä –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ (0, j)
    S21Matrix minor = GetMinorMatrix(0, j);

    // –ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ: (-1)^(i+j) * det(minor)
    double cofactor = minor.Determinant() * ((j % 2 == 0) ? 1 : -1);

    // det += a[0][j] * cofactor
    det += matrix_[0][j] * cofactor;
  }

  return det;
}

// === –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å (–ø—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥) ===
double S21Matrix::Determinant() const {
  if (rows_ != cols_) {
    throw std::out_of_range("Matrix must be square to calculate determinant.");
  }
  return CalcDeterminant();
}

// === –ú–∞—Ç—Ä–∏—Ü–∞ –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π ===
S21Matrix S21Matrix::CalcComplements() const {
  if (rows_ != cols_) {
    throw std::out_of_range("Matrix must be square to calculate complements.");
  }

  if (rows_ == 1) {
    S21Matrix result(1, 1);
    result.matrix_[0][0] = 1;
    return result;
  }

  S21Matrix result(rows_, cols_);

  for (int i = 0; i < rows_; ++i) {
    for (int j = 0; j < cols_; ++j) {
      S21Matrix minor = GetMinorMatrix(i, j);
      double det = minor.Determinant();
      // –ó–Ω–∞–∫: (-1)^(i+j)
      result.matrix_[i][j] = det * ((i + j) % 2 == 0 ? 1 : -1);
    }
  }

  return result;
}

// === –û–±—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞: A^(-1) = (1/det) * C^T ===
S21Matrix S21Matrix::InverseMatrix() const {
  double det = Determinant();
  constexpr double kEpsilon = 1e-7;

  if (std::abs(det) < kEpsilon) {
    throw std::out_of_range("Matrix is singular (determinant is zero).");
  }

  // 1. –ú–∞—Ç—Ä–∏—Ü–∞ –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π
  S21Matrix complements = CalcComplements();

  // 2. –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É–µ–º –µ—ë (–ø–æ–ª—É—á–∞–µ–º —Å–æ—é–∑–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É)
  S21Matrix adjugate = complements.Transpose();

  // 3. –î–µ–ª–∏–º –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å
  adjugate.MulNumber(1.0 / det);

  return adjugate;
}

}  // namespace s21
```

---

### ‚úÖ 5.2. –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–∏—á–∫–∞

| –û–ø–µ—Ä–∞—Ü–∏—è | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ | –ö–∞–∫ –≤ –∫–æ–¥–µ |
|--------|-----------|-----------|
| **–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** | \( A^T_{ij} = A_{ji} \) | –¶–∏–∫–ª: `result[j][i] = matrix[i][j]` |
| **–ú–∏–Ω–æ—Ä** | –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É –∏ —Å—Ç–æ–ª–±–µ—Ü | `GetMinorMatrix(i, j)` ‚Äî –∫–æ–ø–∏—Ä—É–µ–º –≤—Å–µ, –∫—Ä–æ–º–µ i-—Å—Ç—Ä–æ–∫–∏ –∏ j-—Å—Ç–æ–ª–±—Ü–∞ |
| **–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å** | –ß–µ—Ä–µ–∑ –º–∏–Ω–æ—Ä—ã (—Ä–µ–∫—É—Ä—Å–∏—è) | `CalcDeterminant()` –≤—ã–∑—ã–≤–∞–µ—Ç `Determinant()` –¥–ª—è –º–∏–Ω–æ—Ä–æ–≤ |
| **–ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ** | \( C_{ij} = (-1)^{i+j} \cdot \det(M_{ij}) \) | –°—á–∏—Ç–∞–µ–º –º–∏–Ω–æ—Ä, —É–º–Ω–æ–∂–∞–µ–º –Ω–∞ –∑–Ω–∞–∫ |
| **–û–±—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞** | \( A^{-1} = \frac{1}{\det A} C^T \) | `CalcComplements() ‚Üí Transpose() ‚Üí MulNumber(1/det)` |

---

### üîç –ü—Ä–∏–º–µ—Ä: –ü–æ—á–µ–º—É `std::abs(det) < 1e-7`?

–í –° —Ç—ã –ø–∏—Å–∞–ª:
```c
if (det == 0) ...
```

–ù–æ `double` ‚Äî –Ω–µ—Ç–æ—á–Ω—ã–π —Ç–∏–ø.  
–í C++ –ª—É—á—à–µ:
```cpp
if (std::abs(det) < 1e-7)  // "–ø–æ—á—Ç–∏ –Ω–æ–ª—å"
```

> ‚úÖ –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± —Å—Ä–∞–≤–Ω–µ–Ω–∏—è `double`.

---

### ‚úÖ 5.3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

| –û—à–∏–±–∫–∞ | –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º |
|-------|------------------|
| –ù–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ | `throw std::out_of_range("Matrix must be square")` |
| –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å = 0 | `throw std::out_of_range("Matrix is singular")` |
| –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã | –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –Ω–∞—á–∞–ª–µ –º–µ—Ç–æ–¥–∞ |

---

### üìö –ß—Ç–æ –∏–∑—É—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:

| –¢–µ–º–∞ | –†–µ—Å—É—Ä—Å |
|------|--------|
| [–†–µ–∫—É—Ä—Å–∏—è](https://en.cppreference.com/w/cpp/language/recursion) | `Determinant()` –≤—ã–∑—ã–≤–∞–µ—Ç —Å–µ–±—è —á–µ—Ä–µ–∑ –º–∏–Ω–æ—Ä—ã |
| [–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ](https://ru.wikipedia.org/wiki/–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è_–º–∞—Ç—Ä–∏—Ü–∞) | –ü—Ä–æ—Å—Ç–æ –ø–æ–º–µ–Ω—è—Ç—å –∏–Ω–¥–µ–∫—Å—ã |
| [–û–±—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞](https://ru.wikipedia.org/wiki/–û–±—Ä–∞—Ç–Ω–∞—è_–º–∞—Ç—Ä–∏—Ü–∞) | –ß–µ—Ä–µ–∑ —Å–æ—é–∑–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É |
| [std::abs](https://en.cppreference.com/w/cpp/numeric/math/fabs) | –î–ª—è `double` ‚Äî `std::abs`, –Ω–µ `fabs` |

---

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

–£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω:

```bash
ls -l matrix_ops.cpp
```

---

‚úÖ **–≠—Ç–∞–ø 5 –∑–∞–≤–µ—Ä—à—ë–Ω.**  
–¢–µ–ø–µ—Ä—å —Ç—ã —É–º–µ–µ—à—å:
- –†–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å **–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** –Ω–∞ C++.
- –†–∞–±–æ—Ç–∞—Ç—å —Å **—Ä–µ–∫—É—Ä—Å–∏–µ–π** (–æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å).
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏**.
- –ü–∏—Å–∞—Ç—å **—á–∏—Å—Ç—ã–π, –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥**, –±–ª–∏–∑–∫–∏–π –∫ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ.

---

- [–ù–∞–∑–∞–¥ –∫ –æ–≥–ª–∞–≤–ª–µ–Ω–∏—é](README.md)
- [üìò –≠—Ç–∞–ø 6: –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ ‚Äî –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—É —É–¥–æ–±–Ω–æ–π, –∫–∞–∫ –≤ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ](chapter6.md)